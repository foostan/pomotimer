<section ng-controller="TodoCtrl">
  <header>
    <ul class="nav nav-pills">
      <li ng:class="{true: 'active'}[category == 'today']"><a ng-click="category = 'today'">Today</a></li>
      <li ng:class="{true: 'active'}[category == 'inventory']"><a ng-click="category = 'inventory'">Inventory</a></li>
      <li ng:class="{true: 'active'}[category == 'archived']"><a ng-click="category = 'archived'">Archived</a></li>
    </ul>
  </header>

  <sction>
    <div>
        <a class="btn-addtask" ng-click="tm.add({category: category})">
        <i class="glyphicon glyphicon-plus-sign"></i> Add task
      </a>
    </div>
    <div ng-repeat="task in tasks | filter:{category: category}">
      <div class="task" ng:class="{true:'task-done', false:'task-wip'}[task.state=='done']">
        <span class="glyphicon" ng:class="{true:'glyphicon-check', false:'glyphicon-unchecked'}[task.state=='done']" glyphicon-unchecked" ng-click="toggleState(task)"></span>

        <span class="title" editable-text="task.title">
          {{ task.title || 'no title' }}
        </span>

        <span ng-if="task.pomodoro_total != null">
          - 
          <span ng-if="category == 'today'">
            <span class="pomodoro_today" editable-number="task.pomodoro_today" onbeforesave="checkTaskPomodoroToday(task, $data)">
              {{ task.pomodoro_today }}
            </span>
            /
          </span>
          <span class="pomodoro_total" editable-number="task.pomodoro_total" onbeforesave="checkTaskPomodoroTotal(task, $data)">
            {{ task.pomodoro_total }}
          </span>
        </span>

        <a ng-hide="task.state=='done'" class="btn-pomodoro" ng-click="resetPomodoro(task)">
          pomodoro
        </a>

        <a class="btn-deltask" ng-click="tm.del(task)">
            del
        </a>
      </div>
      <div collapse="task.state != 'wip'">
        <span>{{ time }}</span>
        <button ng-click="start(task)" ng-disabled="timer.running">Start Timer</button>
        <button ng-click="stop(task)" ng-disabled="!timer.running">Stop Timer</button>
      </div>
    </div>
  </sction>

  <footer>
  </footer>
</section>
